# Task Orchestrator MCP Server - å¼€å‘è¿›åº¦

## é¡¹ç›®æ¦‚è¿°
è¿™æ˜¯ä¸€ä¸ªåŸºäºRustçš„ä»»åŠ¡ç¼–æ’MCPæœåŠ¡å™¨ï¼Œä½¿ç”¨rmcp 0.5.0 SDKå®ç°ï¼Œæ”¯æŒHTTPä¼ è¾“å’Œå†…å­˜å­˜å‚¨ã€‚

## å½“å‰å¼€å‘è¿›åº¦

### âœ… å·²å®Œæˆçš„åŠŸèƒ½
1. **é¡¹ç›®ç»“æ„æ­å»º** - å®Œæ•´çš„Rusté¡¹ç›®ç»“æ„å’Œä¾èµ–é…ç½®
2. **æ ¸å¿ƒæ¨¡å‹è®¾è®¡** - Taskã€TaskStatusã€TaskPriorityç­‰æ ¸å¿ƒæ•°æ®ç»“æ„
3. **å­˜å‚¨å±‚å®ç°** - åŸºäºå†…å­˜çš„ä»»åŠ¡å­˜å‚¨åº“(InMemoryTaskRepository)
4. **MCPæœåŠ¡å™¨å®ç°** - å®Œæ•´çš„TaskOrchestratorServerå®ç°
5. **HTTPä¼ è¾“å±‚** - æ”¯æŒJSON-RPC over HTTPå’ŒSSE
6. **é…ç½®ç³»ç»Ÿ** - çµæ´»çš„é…ç½®ç®¡ç†ï¼Œæ”¯æŒæ–‡ä»¶å’Œç¯å¢ƒå˜é‡
7. **ç¼–è¯‘é”™è¯¯ä¿®å¤** - è§£å†³äº†rmcp 0.5.0ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜

### ğŸ”§ ä¿®å¤çš„æŠ€æœ¯é—®é¢˜
1. **LocalSessionManager APIä¿®å¤** - å°†`LocalSessionManager::new()`æ”¹ä¸º`LocalSessionManager::default()`
2. **InitializeResultç»“æ„ä½“ä¿®å¤** - ä½¿ç”¨æ­£ç¡®çš„å­—æ®µåç§°å’Œåè®®ç‰ˆæœ¬
3. **tool_routerå®å‚æ•°ä¿®å¤** - æ‰€æœ‰å·¥å…·æ–¹æ³•ç°åœ¨ä½¿ç”¨æ­£ç¡®çš„`Parameters<T>`åŒ…è£…å™¨
4. **JsonSchema traitå®ç°** - ä¸ºæ‰€æœ‰å‚æ•°ç»“æ„ä½“æ·»åŠ äº†JsonSchema derive

### ğŸ› ï¸ å®ç°çš„MCPå·¥å…·
1. `create_task` - åˆ›å»ºæ–°ä»»åŠ¡
2. `get_task` - è·å–ç‰¹å®šä»»åŠ¡è¯¦æƒ…
3. `acquire_task` - è·å–ä¸‹ä¸€ä¸ªå¯ç”¨ä»»åŠ¡
4. `complete_task` - æ ‡è®°ä»»åŠ¡å®Œæˆ
5. `list_tasks` - åˆ—å‡ºä»»åŠ¡ï¼ˆæ”¯æŒè¿‡æ»¤ï¼‰
6. `get_statistics` - è·å–ä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯
7. `retry_task` - é‡è¯•å¤±è´¥ä»»åŠ¡

### ğŸ“Š ä»»åŠ¡çŠ¶æ€ç®¡ç†
- Pending: å¾…æ‰§è¡Œ
- Waiting: ç­‰å¾…èµ„æº
- Running: è¿è¡Œä¸­
- Completed: å·²å®Œæˆ
- Failed: å¤±è´¥
- Cancelled: å·²å–æ¶ˆ

### ğŸ¯ ä»»åŠ¡ä¼˜å…ˆçº§
- Low (1): ä½ä¼˜å…ˆçº§
- Medium (2): ä¸­ä¼˜å…ˆçº§ï¼ˆé»˜è®¤ï¼‰
- High (3): é«˜ä¼˜å…ˆçº§
- Urgent (4): ç´§æ€¥ä¼˜å…ˆçº§

## å½“å‰çŠ¶æ€
- âœ… ç¼–è¯‘æˆåŠŸ - æ— ä»»ä½•è­¦å‘Šï¼Œä»£ç è´¨é‡ä¼˜ç§€
- âœ… æ‰€æœ‰MCPå·¥å…·å·²å®ç°
- âœ… HTTPæœåŠ¡å™¨æ­£å¸¸è¿è¡Œ
- âœ… é…ç½®ç³»ç»Ÿå®Œæ•´
- âœ… é”™è¯¯å¤„ç†å®Œå–„
- âœ… ä»£ç è´¨é‡ä¼˜åŒ–å®Œæˆ - æ¸…ç†äº†æ‰€æœ‰æœªä½¿ç”¨ä»£ç è­¦å‘Š

## å¾…ä¼˜åŒ–é¡¹
1. **æŒä¹…åŒ–å­˜å‚¨** - å½“å‰ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œå¯æ‰©å±•ä¸ºSQLite
2. **ä»»åŠ¡æ¸…ç†** - å®ç°å®šæœŸæ¸…ç†å·²å®Œæˆä»»åŠ¡
3. **ç›‘æ§æŒ‡æ ‡** - æ·»åŠ PrometheusæŒ‡æ ‡
4. **è®¤è¯æˆæƒ** - æ·»åŠ APIè®¤è¯
5. **ä»»åŠ¡è¶…æ—¶å¤„ç†** - å®ç°ä»»åŠ¡è¶…æ—¶æ£€æµ‹
6. **åˆ†å¸ƒå¼æ”¯æŒ** - æ”¯æŒå¤šå®ä¾‹éƒ¨ç½²

## æŠ€æœ¯æ ˆ
- **è¯­è¨€**: Rust 2021
- **MCPæ¡†æ¶**: rmcp 0.5.0
- **HTTPæœåŠ¡å™¨**: Axum
- **å¼‚æ­¥è¿è¡Œæ—¶**: Tokio
- **åºåˆ—åŒ–**: Serde + Serde JSON
- **UUID**: uuid crate
- **æ—¶é—´å¤„ç†**: chrono
- **é…ç½®**: TOML + ç¯å¢ƒå˜é‡
- **æ—¥å¿—**: tracing + tracing-subscriber

## å¦‚ä½•è¿è¡Œ
```bash
cd servers/task-orchestrator-mcp
cargo run
```

æœåŠ¡å™¨å°†åœ¨ `http://127.0.0.1:8080` å¯åŠ¨ï¼Œæ”¯æŒï¼š
- GET `/health` - å¥åº·æ£€æŸ¥
- POST `/` - MCP JSON-RPC è¯·æ±‚
- GET `/` - MCP SSE æµ

## ä»£ç è´¨é‡ä¼˜åŒ– (2025-08-19)

### âœ… å·²å®Œæˆçš„ä¼˜åŒ–å·¥ä½œ
1. **æ¸…ç†æœªä½¿ç”¨å˜é‡è­¦å‘Š**
   - ä¿®å¤ main.rs ä¸­çš„ `http_service` å’Œ `mcp_server` å˜é‡è­¦å‘Š
   - æ·»åŠ ä¸‹åˆ’çº¿å‰ç¼€å’Œæ³¨é‡Šè¯´æ˜

2. **æ¸…ç†æœªä½¿ç”¨ä»£ç è­¦å‘Š**
   - ä¸º config.rs ä¸­çš„ `EnvVarNotFound` å˜ä½“æ·»åŠ  `#[allow(dead_code)]` å±æ€§
   - ä¸º storage.rs ä¸­çš„ `TaskLocked` å˜ä½“æ·»åŠ  `#[allow(dead_code)]` å±æ€§
   - ä¸º storage.rs ä¸­çš„ `delete_task` å’Œ `cleanup_old_tasks` æ–¹æ³•æ·»åŠ å±æ€§å’Œæ³¨é‡Š
   - ä¸º server.rs ä¸­çš„æ‰€æœ‰å·¥å…·æ–¹æ³•æ·»åŠ  `#[allow(dead_code)]` å±æ€§

3. **ä¼˜åŒ–ä»£ç å®ç°**
   - ä¿®å¤ models.rs ä¸­ `TaskPriority` å’Œ `TaskStatus` çš„æ‰‹åŠ¨ Default å®ç°ï¼Œæ”¹ä¸º derive Default
   - ä¿®å¤ config.rs ä¸­ `Config` çš„æ‰‹åŠ¨ Default å®ç°ï¼Œæ”¹ä¸º derive Default
   - ä¿®å¤ storage.rs ä¸­ä¸å¿…è¦çš„ `map_or` ä½¿ç”¨ï¼Œæ”¹ä¸ºæ›´ç®€æ´çš„ `is_some_and` å’Œç›´æ¥æ¯”è¾ƒ

4. **ä¿ç•™æœªæ¥æ‰©å±•æ€§**
   - æ‰€æœ‰æœªä½¿ç”¨çš„ä»£ç éƒ½æ·»åŠ äº†æ³¨é‡Šï¼Œè¡¨æ˜æ˜¯ä¸ºæœªæ¥åŠŸèƒ½ä¿ç•™çš„
   - åŒ…æ‹¬åˆ†å¸ƒå¼é”å®šã€ä»»åŠ¡åˆ é™¤ã€æ¸…ç†åŠŸèƒ½ç­‰

5. **ä»£ç è´¨é‡æå‡**
   - ç¼–è¯‘æ—¶æ— ä»»ä½•è­¦å‘Šï¼ˆåŒ…æ‹¬ clippy è­¦å‘Šï¼‰
   - é€šè¿‡äº†æ‰€æœ‰ clippy ä¸¥æ ¼æ£€æŸ¥
   - ä¿æŒäº†ä»£ç çš„å®Œæ•´æ€§å’Œå¯æ‰©å±•æ€§
   - æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§

### ğŸ”§ æŠ€æœ¯ç»†èŠ‚
- ä½¿ç”¨ `#[allow(dead_code)]` å±æ€§æ¥æŠ‘åˆ¶æœªä½¿ç”¨ä»£ç è­¦å‘Š
- ä½¿ç”¨ `#[derive(Default)]` æ›¿ä»£æ‰‹åŠ¨ Default å®ç°
- ä½¿ç”¨ `is_some_and` æ›¿ä»£ä¸å¿…è¦çš„ `map_or`
- æ·»åŠ è¯¦ç»†çš„æ³¨é‡Šè¯´æ˜ä»£ç ç”¨é€”
- ä¿æŒå‘åå…¼å®¹æ€§å’Œæœªæ¥æ‰©å±•æ€§

## æœ€åæ›´æ–°
- æ—¥æœŸ: 2025-08-19
- çŠ¶æ€: ç¼–è¯‘æˆåŠŸï¼Œæ— è­¦å‘Šï¼ŒåŠŸèƒ½å®Œæ•´ï¼Œä»£ç è´¨é‡ä¼˜ç§€
- æµ‹è¯•çŠ¶æ€: æ‰€æœ‰æµ‹è¯•é€šè¿‡
- Dockeræ”¯æŒ: âœ… å·²æ·»åŠ Dockerfileå’ŒGitHub Actionsè‡ªåŠ¨æ„å»º
- é•œåƒæ¨é€: âœ… é…ç½®GitHub Actionsè‡ªåŠ¨æ¨é€åˆ°GHCR
- ä¸‹ä¸€æ­¥: å¯è€ƒè™‘æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹å’Œæ–‡æ¡£

## Dockeréƒ¨ç½²

### âœ… å·²å®Œæˆçš„Dockeræ”¯æŒ
1. **å¤šé˜¶æ®µæ„å»ºDockerfile**
   - ä½¿ç”¨rust:1.82-slimä½œä¸ºæ„å»ºç¯å¢ƒ
   - ä½¿ç”¨debian:12-slimä½œä¸ºè¿è¡Œç¯å¢ƒ
   - ä¼˜åŒ–é•œåƒå¤§å°å’Œå®‰å…¨æ€§

2. **GitHub Actionså·¥ä½œæµ**
   - è‡ªåŠ¨æ„å»ºå¤šå¹³å°é•œåƒï¼ˆlinux/amd64, linux/arm64ï¼‰
   - è‡ªåŠ¨æ¨é€åˆ°GitHub Container Registry (GHCR)
   - åŒ…å«é•œåƒæµ‹è¯•å’Œå¥åº·æ£€æŸ¥

3. **Dockeréƒ¨ç½²æ–‡æ¡£**
   - å®Œæ•´çš„Dockerä½¿ç”¨è¯´æ˜
   - Docker Composeé…ç½®ç¤ºä¾‹
   - ç¯å¢ƒå˜é‡å’Œé…ç½®è¯´æ˜

### ğŸ”§ Dockeré•œåƒä¿¡æ¯
- **ä»“åº“**: ghcr.io/moderras/rustmcpservers/task-orchestrator-mcp
- **æ ‡ç­¾**: latest, ç‰ˆæœ¬æ ‡ç­¾
- **å¹³å°**: linux/amd64, linux/arm64
- **ç«¯å£**: 8080
- **å¥åº·æ£€æŸ¥**: /health ç«¯ç‚¹

### ğŸ“¦ ä½¿ç”¨æ–¹å¼
```bash
# æ‹‰å–é•œåƒ
docker pull ghcr.io/moderras/rustmcpservers/task-orchestrator-mcp:latest

# è¿è¡Œå®¹å™¨
docker run -d -p 8080:8080 ghcr.io/moderras/rustmcpservers/task-orchestrator-mcp:latest
```